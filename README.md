# random_question
### В данном теcтовом задании реализовано общращение к публичному API и сохранение полученных данных в базу данных postgresql.<br>
Технологии которые используются:<br>
- Python - 3.9 можно скачать и установить https://www.python.org/
- FastAPI - 0.95.2
- SQLAlchemy - 2.0.15
- Docker<br> можно скачать и установить https://docs.docker.com/get-docker/
<br>
До запуска приложения следует создать файл .env в корне проекта, где находится файл docker-compose.yaml<br>
<br>
Содержание файла .env:<br>
APP_TITLE - Заголовок который будет отображен в документации Swagger<br>
SECRET - Секрктный ключ(случайный набор символов)<br>
POSTGRES_DB - Имя базы данных<br>
POSTGRES_USER - Имя пользователя базы данных<br>
POSTGRES_PASSWORD - Пароль<br>
DB_HOST - Хост базы данных(имя контейнера с базой данных)<br>
DB_PORT - Порт базы данных<br>
Нужно заполнить эти данные пример тестовых данных будет в файле .env.example<br>
<br>
Для того чтобы запустить приложение вам нужно собрать образы базы данных и приложения для этого можно выпольнить команду `docker-compose up --build`<br>
скачается образ докера из удаленного репозитория, а также соберется образ на основе Dockerfile создадутся и запустятся контейнеры.<br>
После того как все запуститься надо выполнить команду `docker exec random_question_web_1 alembic upgrade head` чтобы применить миграции,<br>
если не получится возможно у вас другое имя контейнера его можно посмотреть командой docker ps, вместо имени можно написать id-контейнера.<br>
После этого можете открыть документацию Swagger в которой протестировать работу, перейдите по ссылке http://127.0.0.1:8000/docs/ <br>
Пример запроса:<br>
Делаем Post запрос на endpoint `/random_question/` в теле запроса передаем JSON с тем сколько рандомных записей мы хотим получить.<br>
```
{
  "question_num": 0
}
```
При удачном выполнеии первый раз вернется null так-как возвращается предыдущая запись, а если мы делаем первую запись то предыдущей нету.<br>
Вот ответ если это уже не первая запись:<br>
```
{
  "id": 1,
  "answer": "rock and roll",
  "question": "On their Krofft-produced variety show, Marie Osmond was \"a little bit country\" & Donny was \"a little bit\" this",
  "airdate": "2000-07-12T19:00:00"
}
```
При неудачной попытке если вы например попытаетесь передать отрицательно число или 0 то вернется такой ответ:<br>
```
{
  "detail": [
    {
      "loc": [
        "body",
        "question_num"
      ],
      "msg": "Число должно быть положительным",
      "type": "value_error"
    }
  ]
}
```

### В данном теcтовом задании реализовано общращение к публичному API и сохранение полученных данных в базу данных postgresql.<br>
Технологии которые используются:<br>
- Python - 3.9 можно скачать и установить https://www.python.org/
- FastAPI - 0.95.2
- SQLAlchemy - 2.0.15
- Docker<br> можно скачать и установить https://docs.docker.com/get-docker/
<br>
До запуска приложения следует создать файл .env в корне проекта, где находится файл docker-compose.yaml<br>
<br>
Содержание файла .env:<br>
APP_TITLE - Заголовок который будет отображен в документации Swagger<br>
SECRET - Секрктный ключ(случайный набор символов)<br>
POSTGRES_DB - Имя базы данных<br>
POSTGRES_USER - Имя пользователя базы данных<br>
POSTGRES_PASSWORD - Пароль<br>
DB_HOST - Хост базы данных(имя контейнера с базой данных)<br>
DB_PORT - Порт базы данных<br>
Нужно заполнить эти данные пример тестовых данных будет в файле .env.example<br>
<br>
Для того чтобы запустить приложение вам нужно собрать образы базы данных и приложения для этого можно выпольнить команду `docker-compose up --build`<br>
скачается образ докера из удаленного репозитория, а также соберется образ на основе Dockerfile создадутся и запустятся контейнеры.<br>
После того как все запуститься надо выполнить команду `docker exec random_question_web_1 alembic upgrade head` чтобы применить миграции,<br>
если не получится возможно у вас другое имя контейнера его можно посмотреть командой docker ps, вместо имени можно написать id-контейнера.<br>
После этого можете открыть документацию Swagger в которой протестировать работу, перейдите по ссылке http://127.0.0.1:8000/docs/ <br>
Пример запроса:<br>
Делаем Post запрос на endpoint `/random_question/` в теле запроса передаем JSON с тем сколько рандомных записей мы хотим получить.<br>
```
{
  "question_num": 0
}
```
При удачном выполнеии первый раз вернется null так-как возвращается предыдущая запись, а если мы делаем первую запись то предыдущей нету.<br>
Вот ответ если это уже не первая запись:<br>
```
{
  "id": 1,
  "answer": "rock and roll",
  "question": "On their Krofft-produced variety show, Marie Osmond was \"a little bit country\" & Donny was \"a little bit\" this",
  "airdate": "2000-07-12T19:00:00"
}
```
При неудачной попытке если вы например попытаетесь передать отрицательно число или 0 то вернется такой ответ:<br>
```
{
  "detail": [
    {
      "loc": [
        "body",
        "question_num"
      ],
      "msg": "Число должно быть положительным",
      "type": "value_error"
    }
  ]
}
```
